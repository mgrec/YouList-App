<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:8000/connect-playlist https://code.jquery.com/jquery-3.1.1.min.js">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <title>YouList - App</title>
    </head>
    <body>
    <div class="">
        <p>Enter le code de paratge :</p>
        <input id="IDU" type="text"><br>
        <button id="connect">Connection Ã  la playlist</button>
    </div>
    <div class="">
        <button id="pause">PAUSE</button>
        <button id="play">PLAY</button>
    </div>
    <div class="success" style="display: none">
        <p style="color: #4B946A">Connect with success to playList</p>
    </div>
    <div id="result">
        <ul class="list-result">

        </ul>
    </div>
    <div style="display: none">
        <div id="idlist">{{ idlist }}</div>
    </div>
    </body>
    <script
            src="https://code.jquery.com/jquery-3.1.1.min.js"
            integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
            crossorigin="anonymous"></script>
    <script>
        $.support.cors = true;
        $('#connect').click(function (e) {
            $('.success').css('display', 'block');
            $.ajax({
                url: 'http://localhost:8000/connect-playlist',
                type: "POST",
                dataType: 'JSON',
                data: {
                    'IDU': $('#IDU').val()
                },
                success: function (data) {
                    if (data.status == "error") {
                        alert('votre naviagteur ne supporte pas l\'AJAX')
                    } else {
                        $.each(data, function (item, i) {

                            $('.list-result').append('<p>' + i.title + '</p>')
                        });
                            $('#idlist').text(data[0].id_playlist)
                    }
                    console.log(data[0].id_playlist);
                }
            });
        });

        $('#pause').click(function (e) {
            $('.success').css('display', 'block');
            $.ajax({
                url: 'http://localhost:8000/change-playlist-status',
                type: "POST",
                dataType: 'JSON',
                data: {
                    'id_playlist': $('#idlist').text(),
                    'status': 0
                },
                success: function (data) {
                    if (data.status == "error") {
                        alert('votre naviagteur ne supporte pas l\'AJAX')
                    } else {
                        $.each(data, function (item, i) {

                            $('.list-result').append('<p>' + i.title + '</p>')
                        });
                        $('#idlist').text(data[0].id_playlist)
                    }
                    console.log(data[0].id_playlist);
                }
            });
        });

        $('#play').click(function (e) {
            $('.success').css('display', 'block');
            $.ajax({
                url: 'http://localhost:8000/change-playlist-status',
                type: "POST",
                dataType: 'JSON',
                data: {
                    'id_playlist': $('#idlist').text(),
                    'status': 1
                },
                success: function (data) {
                    if (data.status == "error") {
                        alert('votre naviagteur ne supporte pas l\'AJAX')
                    } else {
                        $.each(data, function (item, i) {

                            $('.list-result').append('<p>' + i.title + '</p>')
                        });
                        $('#idlist').text(data[0].id_playlist)
                    }
                    console.log(data[0].id_playlist);
                }
            });
        });
    </script>
</html>

